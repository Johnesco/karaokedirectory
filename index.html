<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Austin Karaoke Directory</title>

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Application styles -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/views.css">
</head>
<body class="page--edge-to-edge">
    <header class="site-header">
        <div class="karaoke-video-bg">
            <!-- Song 1 -->
            <div class="karaoke-lyrics" data-song="0">
                <div class="lyric-line">When the lights, go down</div>
                <div class="lyric-line">in the city...</div>
                <div class="lyric-line">And the sun shines on the bay.</div>
                <div class="lyric-line">Oh I wanna be there, in your city...</div>
            </div>
            <!-- Song 2 -->
            <div class="karaoke-lyrics" data-song="1">
                <div class="lyric-line">Just a small town girl</div>
                <div class="lyric-line">living in a lonely world...</div>
                <div class="lyric-line">She took the midnight train</div>
                <div class="lyric-line">going anywhere...</div>
            </div>
            <!-- Song 3 -->
            <div class="karaoke-lyrics" data-song="2">
                <div class="lyric-line">Is this the real life?</div>
                <div class="lyric-line">Is this just fantasy?</div>
                <div class="lyric-line">Caught in a landslide,</div>
                <div class="lyric-line">no escape from reality...</div>
            </div>
            <!-- Song 4 -->
            <div class="karaoke-lyrics" data-song="3">
                <div class="lyric-line">Sweet Caroline...</div>
                <div class="lyric-line">Good times never seemed so good!</div>
                <div class="lyric-line">I've been inclined...</div>
                <div class="lyric-line">to believe they never would...</div>
            </div>
            <div class="scanlines"></div>
        </div>
        <div class="site-header__content">
            <h1 class="site-header__title">Greater Austin Karaoke Directory</h1>
            <p class="site-header__tagline">Find karaoke near you, every night of the week</p>
        </div>
    </header>

    <div class="app-layout">
        <div class="app-layout__list">
            <nav id="navigation" class="navigation-container"></nav>

            <main id="main-content" class="main-content">
                <!-- Views render here -->
                <div class="loading">
                    <i class="fa-solid fa-spinner fa-spin"></i>
                    Loading venues...
                </div>
            </main>
        </div>

        <aside class="app-layout__detail" id="venue-detail-pane">
            <!-- VenueDetailPane renders here on wide screens -->
        </aside>
    </div>

    <div id="venue-modal"></div>

    <footer class="site-footer">
        <div class="site-footer__social">
            <h2>Follow Us</h2>
            <div class="social-links">
                <a href="https://www.facebook.com/groups/2494105004273043"
                   target="_blank" rel="noopener noreferrer" title="Facebook">
                    <i class="fa-brands fa-facebook fa-lg"></i>
                </a>
                <a href="https://www.instagram.com/karaokedirectory/"
                   target="_blank" rel="noopener noreferrer" title="Instagram">
                    <i class="fa-brands fa-instagram fa-lg"></i>
                </a>
            </div>
        </div>
        <div class="site-footer__links">
            <a href="about.html">About Us</a>
            <a href="submit.html">Submit Venue</a>
        </div>
        <p class="site-footer__copyright">
            &copy; 2025 Austin Karaoke Directory
        </p>
    </footer>

    <!-- Floating Action Buttons -->
    <div class="fab-group">
        <button id="jump-to-today" class="fab-group__btn fab-group__btn--today" aria-label="Jump to today" data-tooltip="Today" hidden>
            <i class="fa-solid fa-calendar-day"></i>
            <span class="fab-label">Today</span>
        </button>
        <button id="back-to-top" class="fab-group__btn fab-group__btn--top" aria-label="Back to top" data-tooltip="Back to top" hidden>
            <i class="fa-solid fa-chevron-up"></i>
        </button>
    </div>

    <!-- Application scripts -->
    <script src="js/data.js"></script>
    <script type="module" src="js/app.js"></script>

    <!-- Back to top and Jump to Today button behavior -->
    <script>
        const backToTop = document.getElementById('back-to-top');
        const jumpToTodayBtn = document.getElementById('jump-to-today');

        function updateTodayButtonVisibility() {
            // Show button if not on current week
            if (typeof window.isCurrentWeek === 'function' && !window.isCurrentWeek()) {
                jumpToTodayBtn.hidden = false;
                return;
            }

            // On current week - show button if today's card is not visible
            const todayCard = document.querySelector('.day-card--today');
            if (todayCard) {
                const rect = todayCard.getBoundingClientRect();
                const isVisible = rect.top < window.innerHeight && rect.bottom > 0;
                jumpToTodayBtn.hidden = isVisible;
            } else {
                jumpToTodayBtn.hidden = true;
            }
        }

        window.addEventListener('scroll', () => {
            backToTop.hidden = window.scrollY < 300;
            updateTodayButtonVisibility();
        });

        // Also update when week changes (check periodically)
        setInterval(updateTodayButtonVisibility, 500);

        backToTop.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        jumpToTodayBtn.addEventListener('click', () => {
            if (typeof window.jumpToToday === 'function') {
                window.jumpToToday();
            }
        });
    </script>

    <!-- Karaoke header animation -->
    <script>
        (function() {
            const header = document.querySelector('.site-header');
            const videoBg = document.querySelector('.karaoke-video-bg');
            const songs = document.querySelectorAll('.karaoke-lyrics');
            const TOTAL_SONGS = songs.length;

            const TITLE_DISPLAY_TIME = 10000; // 10 seconds showing title
            const LYRIC_DISPLAY_TIME = 2500;  // Time per lyric line

            let currentSong = 0;

            function showLyrics() {
                // Get current song container and its lyrics
                const songContainer = songs[currentSong];
                const lyricLines = songContainer.querySelectorAll('.lyric-line');

                // Hide all songs, show current one
                songs.forEach(s => s.classList.remove('active-song'));
                songContainer.classList.add('active-song');

                // Force animation restart by removing and re-adding class
                header.classList.remove('karaoke-active');
                void header.offsetWidth; // Trigger reflow

                // Fade out title, show lyrics
                videoBg.classList.add('active');
                header.classList.add('karaoke-active');

                // Animate each lyric line with staggered timing
                lyricLines.forEach((line, index) => {
                    setTimeout(() => {
                        line.classList.add('visible');
                        line.classList.add('highlight');
                    }, index * LYRIC_DISPLAY_TIME);
                });

                // After all lyrics shown, wait a bit then go back to title
                const lyricsDuration = lyricLines.length * LYRIC_DISPLAY_TIME + 2000;
                setTimeout(showTitle, lyricsDuration);
            }

            function showTitle() {
                // Reset all lyrics in current song
                const songContainer = songs[currentSong];
                const lyricLines = songContainer.querySelectorAll('.lyric-line');
                lyricLines.forEach(line => {
                    line.classList.remove('visible', 'highlight');
                });

                // Fade out lyrics, show title
                videoBg.classList.remove('active');
                header.classList.remove('karaoke-active');

                // Move to next song for next cycle
                currentSong = (currentSong + 1) % TOTAL_SONGS;

                // After title display time, show next song
                setTimeout(showLyrics, TITLE_DISPLAY_TIME);
            }

            // Start the cycle after initial 10 seconds of title
            setTimeout(showLyrics, TITLE_DISPLAY_TIME);
        })();
    </script>
</body>
</html>
